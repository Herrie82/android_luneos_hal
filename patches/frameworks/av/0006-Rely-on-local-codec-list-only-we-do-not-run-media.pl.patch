From 754ec436ab2a94900d517e3ef62efdb107112efa Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Thomas=20Vo=C3=9F?= <thomas.voss.bochum@gmail.com>
Date: Wed, 3 Feb 2016 17:46:38 +0100
Subject: [PATCH 06/10] Rely on local codec list only, we do not run
 media.player/service.

Signed-off-by: Ondrej Kubik <ondrej.kubik@canonical.com>
---
 media/libstagefright/MediaCodecList.cpp | 19 +------------------
 1 file changed, 1 insertion(+), 18 deletions(-)

diff --git a/media/libstagefright/MediaCodecList.cpp b/media/libstagefright/MediaCodecList.cpp
index 280a503..e91890b 100644
--- a/media/libstagefright/MediaCodecList.cpp
+++ b/media/libstagefright/MediaCodecList.cpp
@@ -73,24 +73,7 @@ void MediaCodecList::BinderDeathObserver::binderDied(const wp<IBinder> &who __un
 
 // static
 sp<IMediaCodecList> MediaCodecList::getInstance() {
-    Mutex::Autolock _l(sRemoteInitMutex);
-    if (sRemoteList == NULL) {
-        sp<IBinder> binder =
-            defaultServiceManager()->getService(String16("media.player"));
-        sp<IMediaPlayerService> service =
-            interface_cast<IMediaPlayerService>(binder);
-        if (service.get() != NULL) {
-            sRemoteList = service->getCodecList();
-            if (sRemoteList != NULL) {
-                sBinderDeathObserver = new BinderDeathObserver();
-                binder->linkToDeath(sBinderDeathObserver.get());
-            }
-        }
-        if (sRemoteList == NULL) {
-            // if failed to get remote list, create local list
-            sRemoteList = getLocalInstance();
-        }
-    }
+    sRemoteList = getLocalInstance();
     return sRemoteList;
 }
 
-- 
2.7.4

